$(document).ready(function(){function updateTotalCart(){var total=0;$("td.subtotal").each(function(index){total+=parseInt($(this).text())}),$("td.totalShown span").text(total+"$"),$("td.totalHidden span").text(total+"$"),updateExistCart()}function updateExistCart(){var cartId=$("input.cartNameHolder").val(),cart=[];$(".itemRow").each(function(){var item={};$(this).find(".productMainCategoryHolder").each(function(){item.category=$(this).val()}),$(this).find(".productSubCategoryHolder").each(function(){item.subcategory=$(this).val()}),$(this).find(".productIdHolder").each(function(){item.id=$(this).val()}),$(this).find(".quantity").each(function(){item.quantity=$(this).val()}),cart.push(item)});var cartObj={cartId:cartId,cartContent:cart};$.get("/updateExistingCart",cartObj,function(){})}function modalAnimate($oldForm,$newForm){var $oldH=$oldForm.height(),$newH=$newForm.height();$divForms.css("height",$oldH),$oldForm.fadeToggle($modalAnimateTime,function(){$divForms.animate({height:$newH},$modalAnimateTime,function(){$newForm.fadeToggle($modalAnimateTime)})})}function msgFade($msgId,$msgText){$msgId.fadeOut($msgAnimateTime,function(){$(this).text($msgText).fadeIn($msgAnimateTime)})}function msgChange($divTag,$iconTag,$textTag,$divClass,$iconClass,$msgText){var $msgOld=$divTag.text();msgFade($textTag,$msgText),$divTag.addClass($divClass),$iconTag.removeClass("glyphicon-chevron-right"),$iconTag.addClass($iconClass+" "+$divClass),setTimeout(function(){msgFade($textTag,$msgOld),$divTag.removeClass($divClass),$iconTag.addClass("glyphicon-chevron-right"),$iconTag.removeClass($iconClass+" "+$divClass)},$msgShowTime)}$.get("/newVisitor",function(){}),$(document).on("click",".fa-cart-plus ,button.add-to-cart.btn.btn-default",function(){var path=$(this).prev().val();$.get("/addProductToCart",{path:path},function(data){})}),$(document).on("change",".quantity",function(){var price=parseInt($(this).parent().prev().text()),qty=$(this).val(),subtotal=qty*price;$(this).parent().next().text(subtotal);updateTotalCart()}),$(document).on("click",".removeBtn",function(){$(this).parent().parent().remove(),updateTotalCart()});var $formLogin=$("#login-form"),$formLost=$("#lost-form"),$formRegister=$("#register-form"),$divForms=$("#div-forms"),$modalAnimateTime=300,$msgAnimateTime=150,$msgShowTime=2e3;$("form").submit(function(){switch(this.id){case"login-form":var $lg_username=($("#headerTitle").text("Log In"),$("#login_username").val());$("#login_password").val();return"ERROR"==$lg_username?msgChange($("#div-login-msg"),$("#icon-login-msg"),$("#text-login-msg"),"error","glyphicon-remove","Login error"):msgChange($("#div-login-msg"),$("#icon-login-msg"),$("#text-login-msg"),"success","glyphicon-ok","Login OK"),!1;case"lost-form":$("#headerTitle").text("Retrieve password");return"ERROR"==$("#lost_email").val()?msgChange($("#div-lost-msg"),$("#icon-lost-msg"),$("#text-lost-msg"),"error","glyphicon-remove","Send error"):msgChange($("#div-lost-msg"),$("#icon-lost-msg"),$("#text-lost-msg"),"success","glyphicon-ok","Send OK"),!1;case"register-form":var $rg_username=($("##headerTitle").text("Register"),$("#register_username").val());$("#register_email").val(),$("#register_password").val();return"ERROR"==$rg_username?msgChange($("#div-register-msg"),$("#icon-register-msg"),$("#text-register-msg"),"error","glyphicon-remove","Register error"):msgChange($("#div-register-msg"),$("#icon-register-msg"),$("#text-register-msg"),"success","glyphicon-ok","Register OK"),!1;default:return!1}}),$("#login_register_btn").click(function(){modalAnimate($formLogin,$formRegister)}),$("#register_login_btn").click(function(){modalAnimate($formRegister,$formLogin)}),$("#login_lost_btn").click(function(){modalAnimate($formLogin,$formLost)}),$("#lost_login_btn").click(function(){modalAnimate($formLost,$formLogin)}),$("#lost_register_btn").click(function(){modalAnimate($formLost,$formRegister)}),$("#register_lost_btn").click(function(){modalAnimate($formRegister,$formLost)})});